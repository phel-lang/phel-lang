#!/usr/bin/env php
<?php

declare(strict_types=1);

use Gacela\Framework\Gacela;
use Phel\Command\CommandFacade;
use Symfony\Component\Console\Application;

$projectRootDir = getcwd() . DIRECTORY_SEPARATOR;
$autoloadPath = $projectRootDir . 'vendor' . DIRECTORY_SEPARATOR . 'autoload.php';

if (!file_exists($autoloadPath)) {
    exit("Cannot load composer's autoload file: $autoloadPath\n");
}

require $autoloadPath;

Gacela::bootstrap($projectRootDir);

$commandFacade = new CommandFacade();

$application = new Application();
$application->add($commandFacade->getExportCommand());
$application->add($commandFacade->getFormatCommand());
$application->add($commandFacade->getReplCommand());
$application->add($commandFacade->getRunCommand());
$application->add($commandFacade->getRuntimeCommand());
$application->add($commandFacade->getTestCommand());
$application->run();
